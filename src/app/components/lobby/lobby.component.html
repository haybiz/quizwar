<div class="lobby-container">
    <div class="header">
        <h1 class="title">‚öîÔ∏è Quiz<span class="accent">War</span> ‚öîÔ∏è</h1>
        <p class="subtitle">Waiting Room</p>
    </div>

    <div class="room-code-section">
        <p class="label">Share this code with friends:</p>
        <div class="code-display" (click)="copyCode()">
            <span class="code">{{ roomId() }}</span>
            <span class="copy-hint">
                @if (copied()) {
                ‚úÖ Copied!
                } @else {
                üìã Click to copy
                }
            </span>
        </div>
    </div>

    <div class="players-section">
        <h2 class="section-title">
            <span class="shield">üõ°Ô∏è</span>
            Warriors ({{ playerCount() }})
        </h2>

        <div class="players-list">
            @for (player of players(); track player.id) {
            <div class="player-card" [class.is-host]="player.id === room()?.hostId">
                <div class="player-avatar">
                    {{ player.nickname.charAt(0).toUpperCase() }}
                </div>
                <span class="player-name">{{ player.nickname }}</span>
                @if (player.id === room()?.hostId) {
                <span class="host-badge">üëë Host</span>
                }
                @if (player.id === getPlayerId()) {
                <span class="you-badge">You</span>
                }
            </div>
            }
        </div>
    </div>

    <!-- Game Settings (Host Only) -->
    @if (isHost()) {
    <div class="settings-section">
        <h2 class="section-title">‚öôÔ∏è Game Settings</h2>

        <!-- Question Count -->
        <div class="setting-group">
            <label class="setting-label">Number of Questions</label>
            <div class="question-count-row">
                @for (count of [10, 15, 20, 25, 30, 50]; track count) {
                <button class="count-btn" [class.active]="questionCount() === count" (click)="setQuestionCount(count)">
                    {{ count }}
                </button>
                }
            </div>
        </div>

        <!-- Categories -->
        <div class="setting-group">
            <label class="setting-label">
                Categories
                <span class="setting-hint">
                    ({{ selectedCategoryIds().length }}/4 selected ¬∑ leave empty for all)
                </span>
            </label>
            <div class="categories-grid">
                @for (cat of categories(); track cat.id) {
                <button class="category-chip" [class.active]="isCategorySelected(cat.id)"
                    [disabled]="!isCategorySelected(cat.id) && selectedCategoryIds().length >= 4"
                    (click)="toggleCategory(cat.id)">
                    {{ getShortCategoryName(cat.name) }}
                </button>
                }
            </div>
        </div>
    </div>
    }

    @if (errorMsg()) {
    <div class="error-msg">‚ö†Ô∏è {{ errorMsg() }}</div>
    }

    <div class="actions">
        @if (isHost()) {
        <button class="btn btn-start" [disabled]="!canStart() || isStarting()" (click)="startGame()">
            @if (isStarting()) {
            <span class="spinner"></span> Loading Questions...
            } @else if (playerCount() < 2) { ‚è≥ Need at least 2 players } @else { üöÄ Start Battle! } </button>
                } @else {
                <div class="waiting-msg">
                    <div class="waiting-spinner"></div>
                    <p>Waiting for host to start the battle...</p>
                </div>
                }
    </div>
</div>